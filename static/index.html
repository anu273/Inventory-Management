<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management Tool</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            box-shadow: 20px 20px 60px #d1d9e6, -20px -20px 60px #ffffff;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #b91c1c 100%);
            transition: all 0.3s ease;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.4);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="bg-white rounded-lg shadow-lg p-4 max-w-sm">
            <div class="flex items-center">
                <div id="notification-icon" class="mr-3"></div>
                <div>
                    <div id="notification-title" class="font-semibold text-gray-800"></div>
                    <div id="notification-message" class="text-sm text-gray-600"></div>
                </div>
                <button onclick="hideNotification()" class="ml-4 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <i class="fas fa-boxes text-2xl text-indigo-600 mr-3"></i>
                    <h1 class="text-2xl font-bold text-gray-900">Inventory Management</h1>
                </div>
                <div id="user-info" class="hidden items-center space-x-4">
                    <span id="username-display" class="text-gray-600"></span>
                    <button onclick="logout()" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-sign-out-alt mr-1"></i>Logout
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
        <!-- Auth Section -->
        <div id="auth-section" class="fade-in">
            <div class="max-w-md mx-auto">
                <div class="card rounded-lg p-8">
                    <div class="text-center mb-8">
                        <i class="fas fa-user-circle text-6xl text-indigo-600 mb-4"></i>
                        <h2 class="text-2xl font-bold text-gray-900">Welcome Back</h2>
                        <p class="text-gray-600">Sign in to manage your inventory</p>
                    </div>

                    <!-- Login Form -->
                    <div id="login-form">
                        <form onsubmit="login(event)">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                <input type="text" id="login-username" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input type="password" id="login-password" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <button type="submit" class="w-full btn-primary text-white py-2 px-4 rounded-md font-medium">
                                <i class="fas fa-sign-in-alt mr-2"></i>Sign In
                            </button>
                        </form>
                        <div class="mt-4 text-center">
                            <button onclick="showRegisterForm()" class="text-indigo-600 hover:text-indigo-800">
                                Don't have an account? Register here
                            </button>
                        </div>
                    </div>

                    <!-- Register Form -->
                    <div id="register-form" class="hidden">
                        <form onsubmit="register(event)">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                                <input type="text" id="register-username" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email (Optional)</label>
                                <input type="email" id="register-email"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div class="mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input type="password" id="register-password" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <button type="submit" class="w-full btn-primary text-white py-2 px-4 rounded-md font-medium">
                                <i class="fas fa-user-plus mr-2"></i>Register
                            </button>
                        </form>
                        <div class="mt-4 text-center">
                            <button onclick="showLoginForm()" class="text-indigo-600 hover:text-indigo-800">
                                Already have an account? Sign in here
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="hidden">
            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="card rounded-lg p-6">
                    <div class="flex items-center">
                        <div class="p-3 rounded-full bg-blue-100 text-blue-600 mr-4">
                            <i class="fas fa-boxes text-xl"></i>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-gray-900" id="total-products">0</div>
                            <div class="text-sm text-gray-600">Total Products</div>
                        </div>
                    </div>
                </div>
                <div class="card rounded-lg p-6">
                    <div class="flex items-center">
                        <div class="p-3 rounded-full bg-yellow-100 text-yellow-600 mr-4">
                            <i class="fas fa-dollar-sign text-xl"></i>
                        </div>
                        <div>
                            <div class="text-2xl font-bold text-gray-900" id="total-value">$0</div>
                            <div class="text-sm text-gray-600">Total Value</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions -->
            <div class="mb-6">
                <button onclick="showAddProductModal()" class="btn-primary text-white px-6 py-2 rounded-md font-medium">
                    <i class="fas fa-plus mr-2"></i>Add Product
                </button>
                <button onclick="loadProducts()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-md font-medium ml-2">
                    <i class="fas fa-refresh mr-2"></i>Refresh
                </button>
            </div>

            <!-- Products Table -->
            <div class="card rounded-lg overflow-hidden">
                <div class="px-6 py-4 border-b">
                    <h3 class="text-lg font-semibold text-gray-900">Products Inventory</h3>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">SKU</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Quantity</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="products-table" class="bg-white divide-y divide-gray-200">
                            <!-- JS will populate this -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Product Modal -->
    <div id="add-product-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Add New Product</h3>
                <button onclick="hideAddProductModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form onsubmit="addProduct(event)">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Product Name *</label>
                    <input type="text" id="product-name" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">SKU *</label>
                    <input type="text" id="product-sku" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Type</label>
                    <input type="text" id="product-type"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Quantity *</label>
                    <input type="number" id="product-quantity" required min="0"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Price *</label>
                    <input type="number" id="product-price" required min="0" step="0.01"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Image URL</label>
                    <input type="url" id="product-image"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                    <textarea id="product-description" rows="3"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="hideAddProductModal()"
                        class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                        Cancel
                    </button>
                    <button type="submit" class="btn-primary text-white px-4 py-2 rounded-md">
                        <i class="fas fa-plus mr-2"></i>Add Product
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Update Quantity Modal -->
    <div id="update-quantity-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-sm w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-lg font-semibold text-gray-900">Update Quantity</h3>
                <button onclick="hideUpdateQuantityModal()" class="text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form onsubmit="updateQuantity(event)">
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Product</label>
                    <div id="update-product-name" class="text-gray-900 font-medium"></div>
                </div>
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">New Quantity</label>
                    <input type="number" id="new-quantity" required min="0"
                        class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="hideUpdateQuantityModal()"
                        class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                        Cancel
                    </button>
                    <button type="submit" class="btn-primary text-white px-4 py-2 rounded-md">
                        <i class="fas fa-save mr-2"></i>Update
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-confirmation-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg p-8 max-w-sm w-full mx-4">
            <div class="text-center">
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100">
                     <i class="fas fa-exclamation-triangle text-red-600 text-xl"></i>
                </div>
                <h3 class="text-lg leading-6 font-medium text-gray-900 mt-5">Delete Product</h3>
                <div class="mt-2 px-7 py-3">
                    <p class="text-sm text-gray-500">
                        Are you sure you want to delete <strong id="delete-product-name"></strong>? This action cannot be undone.
                    </p>
                </div>
                <div class="mt-5 flex justify-center space-x-3">
                    <button type="button" onclick="hideDeleteConfirmationModal()"
                        class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                        Cancel
                    </button>
                    <button onclick="handleDeleteProduct()" class="btn-danger text-white px-4 py-2 rounded-md">
                        <i class="fas fa-trash-alt mr-2"></i>Delete
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_BASE_URL = 'http://localhost:5000';
        let currentToken = localStorage.getItem('authToken');
        let currentUser = null;
        let selectedProductId = null; // Used for both update and delete

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            if (currentToken) {
                fetchUserProfile().then(() => {
                    showDashboard();
                    loadProducts();
                }).catch(() => {
                    logout();
                });
            } else {
                showAuth();
                renderProductsTable([]);
            }
        });

        // Utility Functions
        function showNotification(title, message, type = 'success') {
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notification-icon');
            const titleEl = document.getElementById('notification-title');
            const messageEl = document.getElementById('notification-message');

            const icons = {
                success: '<i class="fas fa-check-circle text-green-500 text-xl"></i>',
                error: '<i class="fas fa-exclamation-circle text-red-500 text-xl"></i>',
                warning: '<i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>',
                info: '<i class="fas fa-info-circle text-blue-500 text-xl"></i>'
            };

            icon.innerHTML = icons[type] || icons.info;
            titleEl.textContent = title;
            messageEl.textContent = message;

            notification.classList.add('show');

            setTimeout(() => {
                hideNotification();
            }, 5000);
        }

        function hideNotification() {
            document.getElementById('notification').classList.remove('show');
        }

        function showAuth() {
            document.getElementById('auth-section').classList.remove('hidden');
            document.getElementById('dashboard-section').classList.add('hidden');
            document.getElementById('user-info').classList.add('hidden');
        }

        function showDashboard() {
            document.getElementById('auth-section').classList.add('hidden');
            document.getElementById('dashboard-section').classList.remove('hidden');
            document.getElementById('user-info').classList.remove('hidden');
            
            if (currentUser) {
                document.getElementById('username-display').textContent = `Welcome, ${currentUser.username}`;
            }
        }

        function showLoginForm() {
            document.getElementById('login-form').classList.remove('hidden');
            document.getElementById('register-form').classList.add('hidden');
        }

        function showRegisterForm() {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('register-form').classList.remove('hidden');
        }

        // API Functions
        async function apiRequest(endpoint, options = {}) {
            const url = `${API_BASE_URL}${endpoint}`;
            const config = {
                headers: {
                    'Content-Type': 'application/json',
                    ...options.headers
                },
                ...options
            };

            if (currentToken && !config.headers.Authorization) {
                config.headers.Authorization = `Bearer ${currentToken}`;
            }

            try {
                const response = await fetch(url, config);
                
                if (response.status === 204) { // No Content for successful DELETE
                    return null;
                }

                const data = await response.json();
                
                if (!response.ok) {
                    if (response.status === 401) { // Unauthorized
                        logout();
                    }
                    throw new Error(data.msg || data.message || 'Request failed');
                }
                
                return data;
            } catch (error) {
                console.error('API Request failed:', error);
                throw error;
            }
        }

        // Authentication Functions
        async function register(event) {
            event.preventDefault();
            
            const username = document.getElementById('register-username').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;

            try {
                await apiRequest('/register', {
                    method: 'POST',
                    body: JSON.stringify({ username, email, password })
                });

                showNotification('Success', 'Registration successful! Please log in.', 'success');
                showLoginForm();
                event.target.reset();
                
            } catch (error) {
                showNotification('Registration Failed', error.message, 'error');
            }
        }

        async function login(event) {
            event.preventDefault();
            
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;

            try {
                const response = await apiRequest('/login', {
                    method: 'POST',
                    body: JSON.stringify({ username, password })
                });

                currentToken = response.access_token;
                localStorage.setItem('authToken', currentToken);
                
                currentUser = response.user || { username };
                
                showNotification('Success', 'Login successful!', 'success');
                showDashboard();
                loadProducts();
                
            } catch (error) {
                showNotification('Login Failed', error.message, 'error');
            }
        }

        function logout() {
            currentToken = null;
            currentUser = null;
            localStorage.removeItem('authToken');
            
            showNotification('Success', 'Logged out successfully', 'info');
            showAuth();
            renderProductsTable([]);
            
            document.getElementById('login-username').value = '';
            document.getElementById('login-password').value = '';
        }

        async function fetchUserProfile() {
            try {
                const profile = await apiRequest('/profile');
                currentUser = profile;
            } catch (error) {
                console.error("Failed to fetch profile, token might be invalid.");
                throw error;
            }
        }

        // Product Functions
        async function loadProducts() {
            try {
                const products = await apiRequest('/products');
                updateStats(products);
                renderProductsTable(products);
            } catch (error) {
                showNotification('Error', 'Failed to load products: ' + error.message, 'error');
            }
        }

        function updateStats(products) {
            const totalProducts = products.length;
            const totalValue = products.reduce((sum, p) => sum + (p.quantity * p.price), 0);

            document.getElementById('total-products').textContent = totalProducts;
            document.getElementById('total-value').textContent = `$${totalValue.toFixed(2)}`;
        }

        function renderProductsTable(products) {
            const tbody = document.getElementById('products-table');
            
            if (products.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" class="px-6 py-8 text-center text-gray-500">
                            <i class="fas fa-box-open text-4xl mb-2"></i>
                            <div>No products found. Add your first product to get started!</div>
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = products.map(product => `
                <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            ${product.image_url ? 
                                `<img class="h-10 w-10 rounded-full object-cover mr-3" src="${product.image_url}" alt="${product.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                                 <div class="h-10 w-10 rounded-full bg-gray-200 hidden items-center justify-center mr-3">
                                     <i class="fas fa-box text-gray-500"></i>
                                 </div>` : 
                                `<div class="h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center mr-3">
                                     <i class="fas fa-box text-gray-500"></i>
                                 </div>`
                            }
                            <div>
                                <div class="text-sm font-medium text-gray-900">${product.name}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${product.sku}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${product.type || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${product.quantity}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$${product.price.toFixed(2)}</td>
                    <td class="px-6 py-4 text-sm text-gray-500 max-w-xs truncate" title="${product.description || ''}">
                        ${product.description || '-'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="showUpdateQuantityModal(${product.id}, '${product.name.replace(/'/g, "\\'")}', ${product.quantity})" 
                            class="text-indigo-600 hover:text-indigo-900 mr-3">
                            <i class="fas fa-edit"></i> Update
                        </button>
                        <button onclick="showDeleteConfirmationModal(${product.id}, '${product.name.replace(/'/g, "\\'")}')" 
                            class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash-alt"></i> Delete
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        async function addProduct(event) {
            event.preventDefault();
            
            const productData = {
                name: document.getElementById('product-name').value,
                sku: document.getElementById('product-sku').value,
                type: document.getElementById('product-type').value,
                quantity: parseInt(document.getElementById('product-quantity').value),
                price: parseFloat(document.getElementById('product-price').value),
                image_url: document.getElementById('product-image').value,
                description: document.getElementById('product-description').value
            };

            try {
                await apiRequest('/products', {
                    method: 'POST',
                    body: JSON.stringify(productData)
                });

                showNotification('Success', 'Product added successfully!', 'success');
                hideAddProductModal();
                loadProducts();
                event.target.reset();
                
            } catch (error) {
                showNotification('Error', 'Failed to add product: ' + error.message, 'error');
            }
        }

        async function updateQuantity(event) {
            event.preventDefault();
            
            const newQuantity = parseInt(document.getElementById('new-quantity').value);

            try {
                await apiRequest(`/products/${selectedProductId}/quantity`, {
                    method: 'PUT',
                    body: JSON.stringify({ quantity: newQuantity })
                });

                showNotification('Success', 'Quantity updated successfully!', 'success');
                hideUpdateQuantityModal();
                loadProducts();
                
            } catch (error) {
                showNotification('Error', 'Failed to update quantity: ' + error.message, 'error');
            }
        }

        async function handleDeleteProduct() {
            try {
                await apiRequest(`/products/${selectedProductId}`, {
                    method: 'DELETE'
                });
                showNotification('Success', 'Product deleted successfully!', 'success');
                hideDeleteConfirmationModal();
                loadProducts();
            } catch (error) {
                showNotification('Error', 'Failed to delete product: ' + error.message, 'error');
            }
        }

        // Modal Functions
        function showAddProductModal() {
            document.getElementById('add-product-modal').classList.remove('hidden');
            document.getElementById('add-product-modal').classList.add('flex');
        }

        function hideAddProductModal() {
            document.getElementById('add-product-modal').classList.add('hidden');
            document.getElementById('add-product-modal').classList.remove('flex');
        }

        function showUpdateQuantityModal(productId, productName, currentQuantity) {
            selectedProductId = productId;
            document.getElementById('update-product-name').textContent = productName;
            document.getElementById('new-quantity').value = currentQuantity;
            
            document.getElementById('update-quantity-modal').classList.remove('hidden');
            document.getElementById('update-quantity-modal').classList.add('flex');
        }

        function hideUpdateQuantityModal() {
            document.getElementById('update-quantity-modal').classList.add('hidden');
            document.getElementById('update-quantity-modal').classList.remove('flex');
            selectedProductId = null;
        }

        function showDeleteConfirmationModal(productId, productName) {
            selectedProductId = productId;
            document.getElementById('delete-product-name').textContent = productName;
            document.getElementById('delete-confirmation-modal').classList.remove('hidden');
            document.getElementById('delete-confirmation-modal').classList.add('flex');
        }

        function hideDeleteConfirmationModal() {
            document.getElementById('delete-confirmation-modal').classList.add('hidden');
            document.getElementById('delete-confirmation-modal').classList.remove('flex');
            selectedProductId = null;
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            const modals = ['add-product-modal', 'update-quantity-modal', 'delete-confirmation-modal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    modal.classList.add('hidden');
                    modal.classList.remove('flex');
                }
            });
        });
    </script>
</body>
</html>
